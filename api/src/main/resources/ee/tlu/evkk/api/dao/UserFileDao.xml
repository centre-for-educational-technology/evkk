<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="ee.tlu.evkk.api.dao.UserFileDao">

  <select id="insert" flushCache="true" resultType="java.util.UUID">
    insert into core.user_file (user_file_id,
                                user_id,
                                file_id)
    values (coalesce(#{userFile.userFileId}, uuid_generate_v4()),
            #{userFile.userId},
            #{userFile.fileId});
  </select>

  <select id="findViewsByUserId" resultType="ee.tlu.evkk.api.dao.dto.UserFile">
    select *
    from core.user_files
    where user_id = #{userId}
      and deleted_at is null
    order by created_at desc;
  </select>

</mapper>
